:root {
    /* 
      DYNAMIC SCALING VARIABLE
      JavaScript will update this value in real-time.
      We set a default of 1 for when JS hasn't run yet.
    */
    --scale-factor: 0.5;

    /* Colors and other variables */
    --primary-color: #74ADE6;
    --primary-color-darker: #5a95d3;
    --primary-color-light: #e7f0ff;
    --primary-color-lighter: #f0f6ff;
    --text-color-dark: #212529;
    --text-color-medium: #495057;
    --text-color-light: #6c757d;
    --text-color-muted: #adb5bd;
    --bg-color-light: #f8f9fa;
    --bg-color-reports-page: #f4f6f9;
    --bg-color-lighter: #ffffff;
    --bg-color-white: #ffffff;
    --border-color-soft: #e9ecef;
    --border-color-medium: #dee2e6;
    --green: #198754;
    --red: #dc3545;
    --orange: #fd7e14;
    --dark-bg-color: #212529;
    --dark-bg-color-medium: #343a40;
    --dark-bg-color-light: #495057;
    --dark-text-color: #f8f9fa;
    --dark-text-color-medium: #e9ecef;
    --dark-text-color-light: #ced4da;
    --dark-border-color: #495057;
    --dark-border-color-soft: #343a40;
    --dark-shadow-color: rgba(255, 255, 255, 0.05);
    --dark-primary-lighter: #2c3e50;
    --dark-green: #20c997;
    --dark-red: #f07681;
    --dark-orange: #fd9843;
    --cursor-animation-duration: 0.7s;
}

body.dark-mode {
     --orange: var(--dark-orange);
     --green-light: var(--dark-green);
     --red-light: var(--dark-red);
     --border-color-medium: var(--dark-text-color-light);
     --bg-color-reports-page: var(--dark-bg-color);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

html, body { 
    height: 100%; 
    width: 100%; 
    overflow: hidden;
}

body {
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
    background-color: transparent;
    color: var(--text-color-medium);
    line-height: 1.6;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

body.dark-mode {
    background-color: transparent;
    color: var(--dark-text-color-medium);
}

/* --- NEW STYLES FOR LOADING INDICATOR --- */
#loading-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #495057;
}

.spinner {
    width: 48px;
    height: 48px;
    border: 5px solid #f3f3f3;
    border-top: 5px solid #5a95d3; /* Use a theme color */
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 1rem;
}

#loading-indicator p {
    font-size: 1.1rem;
    font-weight: 500;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Class to hide the main container initially */
.page-container.hidden {
    display: none;
}
/* --- END OF NEW STYLES --- */

.page-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
    background-color: transparent;
    font-size: calc(16px * var(--scale-factor));
}

.main-layout {
    display: flex;
    flex-grow: 1;
    min-height: 0;
}

.content-area { 
    flex-grow: 1;
    height: 100%; 
    overflow-y: auto; 
    padding: 1.5em 2.5em;
    background-color: var(--bg-color-reports-page);
    display: flex;
    flex-direction: column;
}

/* --- HEADER STYLES --- */
.page-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    padding: 0.5em 1.875em; 
    background: linear-gradient(to right, var(--bg-color-lighter), var(--primary-color-lighter)); 
    border-bottom: 0.0625em solid var(--border-color-soft); 
    flex-shrink: 0; 
    min-height: 3.125em; 
}
.header-logo { font-weight: 700; font-size: 1.1em; color: var(--text-color-dark); }
.header-center { color: var(--text-color-light); padding: 0.25em 0; font-size: 0.9em; font-weight: 500; }
.header-right { display: flex; align-items: center; gap: 1em; }
.header-right .lang { font-size: 0.9em; color: var(--text-color-light); font-weight: 600; padding: 0.25em 0.5em; border-radius: 0.5em; cursor: pointer; }
body.dark-mode .page-header { background: linear-gradient(to right, var(--dark-bg-color-light), var(--dark-primary-lighter)); border-bottom-color: var(--dark-border-color); }
body.dark-mode .header-logo, body.dark-mode .header-right .lang:hover { color: var(--dark-text-color); }
body.dark-mode .header-center, body.dark-mode .header-right .lang { color: var(--dark-text-color-light); }
body.dark-mode .header-right .lang.active { color: var(--primary-color); }
/* --- END OF HEADER STYLES --- */

.nps-graph-modal-overlay, #xlsReportModalOverlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex; align-items: center; justify-content: center;
    z-index: 10000; opacity: 0; visibility: hidden;
    transition: opacity 0.3s ease-out, visibility 0s linear 0.3s;
    padding: 1em;
}
.nps-graph-modal-overlay.visible, #xlsReportModalOverlay.visible { opacity: 1; visibility: visible; transition-delay: 0s; }
.nps-graph-modal {
    background-color: var(--bg-color-white); 
    border-radius: 0.75em;
    box-shadow: 0 0.25em 0.75em rgba(0, 0, 0, 0.08); 
    width: 100%; 
    max-width: 62.5em; 
    padding: 0;
    transform: scale(0.95) translateY(1.25em);
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease-out;
    opacity: 0; 
    display: flex; 
    flex-direction: column; 
    max-height: 90vh;
}
.nps-graph-modal-overlay.visible .nps-graph-modal { transform: scale(1) translateY(0); opacity: 1; }
body.dark-mode .nps-graph-modal { background-color: var(--dark-bg-color-light); }

.fake-mouse-cursor { position: fixed; width: 1.5em; height: 1.5em; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="black" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path><path d="M13 13l6 6"></path></svg>'); background-size: contain; background-repeat: no-repeat; z-index: 25000; pointer-events: none; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-out, top var(--cursor-animation-duration) cubic-bezier(0.645, 0.045, 0.355, 1), left var(--cursor-animation-duration) cubic-bezier(0.645, 0.045, 0.355, 1); transform-origin: top left; }
.fake-mouse-cursor.visible { opacity: 1; visibility: visible; }
.fake-mouse-cursor.clicking { transform: scale(0.85); transition: transform 0.08s ease-out !important; }

body.dark-mode .content-area { background-color: var(--dark-bg-color); }

#reportsPageContent { display: flex; flex-direction: column; width: 100%; height: 100%;}
#reportsPageContent .content-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.25em; padding: 0; }
#reportsPageContent .content-title { font-size: 1.8em; color: var(--text-color-dark); font-weight: 600; margin:0; }
.button { padding: 0.5em 1em; border-radius: 0.5em; font-weight: 500; font-size: 0.9em; cursor: pointer; display: inline-flex; align-items: center; gap: 0.4em; line-height: 1.5; }
.button.primary-outline-button.reports-add-new-top { background-color: var(--bg-color-white); border: 0.0625em solid var(--border-color-medium); color: var(--text-color-medium); }
.button.primary-button.reports-add-new-bottom { background: var(--orange); color: white; border: none; border-radius: 1.25em; padding: 0.6em 1.25em; }
.search-bar-container.reports-search-bar { display: flex; align-items: center; background-color: var(--bg-color-white); border: 0.0625em solid var(--border-color-medium); border-radius: 0.5em; padding: 0.6em 1em; margin-bottom: 1.25em; }
.search-bar-container.reports-search-bar .search-icon { color: var(--text-color-muted); margin-right: 0.6em; font-size: 1em; }
.reports-table-container { flex-grow: 1; display: flex; flex-direction: column; }
.reports-table-header { display: flex; padding: 0.6em 1em; color: var(--text-color-light); font-size: 0.8em; font-weight: 500; text-transform: uppercase; letter-spacing: 0.03em; border-bottom: 0.0625em solid var(--border-color-soft); }
.reports-table-body { display: flex; flex-direction: column; }
.reports-table-row { display: flex; align-items: center; padding: 1.1em 1em; background-color: var(--bg-color-white); border-radius: 0.5em; margin-bottom: 0.6em; box-shadow: 0 0.125em 0.25em rgba(0,0,0,0.05); }
.reports-col-name { flex: 2; font-weight: 500; color: var(--text-color-dark); }
.reports-col-survey { flex: 3; }
.reports-col-survey a { color: var(--primary-color-darker); text-decoration: none; font-weight: 500; }
.reports-col-period { flex: 2; text-align: left; color: var(--text-color-medium); }
.reports-col-actions { flex: 1.5; display: flex; align-items: center; justify-content: flex-end; gap: 0.6em; }
.xls-badge { background-color: #daf0e9; color: #1fab89; padding: 0.3em 0.75em; border-radius: 0.3em; font-size: 0.75em; font-weight: 700; letter-spacing: 0.03em; cursor: pointer; }
.icon-button-table { background: none; border: none; color: var(--text-color-muted); cursor: pointer; font-size: 0.9em; padding: 0.3em; line-height: 1; }
.reports-add-new-bottom { margin-top: 1.5em; align-self: flex-start; }

#xlsReportModal .xls-modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1em 1.25em; border-bottom: 0.0625em solid var(--border-color-soft); flex-shrink: 0; }
#xlsReportModal .xls-modal-title { font-size: 1.4em; font-weight: 600; color: var(--text-color-dark); }
#xlsReportModal .xls-modal-close-btn { background: none; border: none; font-size: 1.6em; color: var(--text-color-muted); cursor: pointer; padding: 0.3em; line-height: 1; }
#xlsReportModal .xls-modal-body { overflow-y: auto; flex-grow: 1; }
#xlsReportModal .report-container { max-width: 100%; margin:0; padding: 1.25em; }
#xlsReportModal .header-info { text-align: center; margin-bottom: 1em; border-bottom: 0.0625em solid var(--border-color-soft); padding-bottom: 0.6em; }
#xlsReportModal .header-info h1 { margin: 0 0 0.3em 0; font-size: 1.4em; color: var(--text-color-dark); }
#xlsReportModal .header-info p.header-details { margin: 0; font-size: 0.75em; color: var(--text-color-light); line-height: 1.4; }
#xlsReportModal .main-content { display: grid; grid-template-columns: 25% 37.5% 37.5%; gap: 1em; margin-top: 1em; padding-top: 1em; align-items: stretch; }
#xlsReportModal .metric-box, #xlsReportModal .chart-box { border: 0.0625em solid var(--border-color-medium); padding: 0.75em; border-radius: 0.25em; background-color: var(--bg-color-white); display: flex; flex-direction: column; box-shadow: 0.125em 0.125em 0.3em rgba(0,0,0,0.05); min-width: 0; }
#xlsReportModal .metric-box h3, #xlsReportModal .chart-box h3 { margin-top: 0; font-size: 1em; color: var(--text-color-dark); border-bottom: 0.0625em solid var(--border-color-soft); padding-bottom: 0.3em; margin-bottom: 0.5em; text-align: center; font-weight: bold; flex-shrink: 0; }
#xlsReportModal .csat-value { font-size: 0.9em; font-weight: bold; text-align: center; margin-bottom: 0.3em; flex-shrink: 0; color: var(--text-color-dark); }
#xlsReportModal .nps-label { font-size: 0.9em; color: var(--text-color-medium); margin-bottom: 0.5em; flex-shrink: 0; }
#xlsReportModal .nps-gauge-wrapper, #xlsReportModal .chart-canvas-container { position: relative; width: 100%; height: 7.5em; margin-top: auto; margin-bottom: 0px; display: flex; align-items: center; justify-content: center; }
#xlsReportModal .nps-gauge-wrapper { max-width: 15em; margin-left: auto; margin-right: auto; }
#xlsReportModal .nps-gauge-needle { position: absolute; bottom: 0; left: 50%; width: 0.2em; height: 85%; background-color: var(--text-color-dark); transform-origin: bottom center; transition: transform 2.1s ease-in-out; z-index: 10; border-top-left-radius: 50%; border-top-right-radius: 50%; }
#xlsReportModal .nps-gauge-value-overlay { position: absolute; top: 75%; left: 50%; transform: translate(-50%, -50%); font-size: 1.1em; font-weight: bold; color: var(--text-color-dark); z-index: 5; }
#xlsReportModal .percentage-results, #xlsReportModal .count-results { height: 0; margin-bottom: 0; visibility: hidden; }
#xlsReportModal .total-reviews { text-align: right; font-size: 0.7em; color: var(--text-color-light); margin-bottom: 0.2em; flex-shrink: 0; }
#xlsReportModal .table-container { margin-top: 1.5em; padding-top: 1em; border-top: 0.0625em solid var(--border-color-medium); }
#xlsReportModal .table-container h2 { font-size: 1em; margin-bottom: 0.6em; font-weight: bold; color: var(--text-color-dark); }
#xlsReportModal .table-container table { width: 100%; border-collapse: collapse; font-size: 0.75em; }
#xlsReportModal .table-container th, #xlsReportModal .table-container td { border: 0.0625em solid var(--border-color-medium); padding: 0.25em 0.4em; text-align: right; vertical-align: middle; }
#xlsReportModal .scrollable-table-wrapper { max-height: 11.25em; overflow-y: auto; position: relative; border: 0.0625em solid var(--border-color-medium); margin-top: 0.3em; }

/* Scrollbar Styles */
#xlsReportModal .scrollable-table-wrapper::-webkit-scrollbar { width: 0.5em; height: 0.5em; }
#xlsReportModal .scrollable-table-wrapper::-webkit-scrollbar-track { background-color: var(--border-color-soft); border-radius: 0.25em; }
#xlsReportModal .scrollable-table-wrapper::-webkit-scrollbar-thumb { background-color: var(--text-color-muted); border-radius: 0.25em; border: 0.125em solid transparent; background-clip: content-box; }
#xlsReportModal .scrollable-table-wrapper { scrollbar-width: thin; scrollbar-color: var(--text-color-muted) var(--border-color-soft); }

/* Dark Mode Styles */
body.dark-mode .content-area { background-color: var(--dark-bg-color); }
body.dark-mode #reportsPageContent .content-title { color: var(--primary-color); }
/* ... (rest of dark mode styles are the same) ... */

